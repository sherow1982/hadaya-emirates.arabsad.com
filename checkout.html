<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ุฅุชูุงู ุงูุทูุจ | ูุฏุงูุง ุงูุฅูุงุฑุงุช</title>
    <meta name="description" content="ุฃุชู ุทูุจู ุจุฃูุงู ูุงุญุตู ุนูู ููุชุฌุงุชู ุจุฃุณุฑุน ููุช">
    <link rel="stylesheet" href="style.css">
</head>
<body>
    <!-- Header -->
    <header class="header">
        <nav class="navbar">
            <div class="container">
                <div class="nav-brand">
                    <a href="/" class="logo">
                        <h1>๐ ูุฏุงูุง ุงูุฅูุงุฑุงุช</h1>
                    </a>
                </div>
            </div>
        </nav>
    </header>

    <!-- Checkout Section -->
    <section style="padding: 120px 20px 60px; max-width: 600px; margin: 0 auto;">
        <h1 style="text-align: center; margin-bottom: 2rem; color: #333;">ุฅุชูุงู ุงูุทูุจ</h1>
        
        <form id="checkout-form" style="background: white; padding: 2rem; border-radius: 15px; box-shadow: 0 10px 30px rgba(0,0,0,0.1);">
            <div style="margin-bottom: 1.5rem;">
                <label style="display: block; margin-bottom: 0.5rem; color: #333; font-weight: 600;">ุงูุงุณู ุงููุงูู *</label>
                <input type="text" id="fullName" required 
                       style="width: 100%; padding: 12px; border: 2px solid #e0e0e0; border-radius: 8px; font-size: 16px; transition: border-color 0.3s;" 
                       placeholder="ุฃุฏุฎู ุงุณูู ุงููุงูู">
                <div id="name-error" class="error-message" style="color: #ff6b6b; font-size: 12px; margin-top: 5px; display: none;">ูุฑุฌู ุฅุฏุฎุงู ุงูุงุณู ุงููุงูู</div>
            </div>
            
            <div style="margin-bottom: 1.5rem;">
                <label style="display: block; margin-bottom: 0.5rem; color: #333; font-weight: 600;">ุงูุนููุงู *</label>
                <textarea id="address" required rows="3" 
                          style="width: 100%; padding: 12px; border: 2px solid #e0e0e0; border-radius: 8px; font-size: 16px; resize: vertical;" 
                          placeholder="ุงูุนููุงูู ุจุงูุชูุตูู (ุงูููุทูุฉุ ุงูุดุงุฑุนุ ุฑูู ุงููุจูู)"></textarea>
                <div id="address-error" class="error-message" style="color: #ff6b6b; font-size: 12px; margin-top: 5px; display: none;">ูุฑุฌู ุฅุฏุฎุงู ุงูุนููุงู ุจุงูุชูุตูู</div>
            </div>
            
            <div style="margin-bottom: 1.5rem;">
                <label style="display: block; margin-bottom: 0.5rem; color: #333; font-weight: 600;">ุฑูู ุงูุฌูุงู (ุฏุงุฎู ุงูุฅูุงุฑุงุช) *</label>
                <input type="tel" id="phone" required 
                       style="width: 100%; padding: 12px; border: 2px solid #e0e0e0; border-radius: 8px; font-size: 16px;" 
                       placeholder="05xxxxxxxx ุฃู +9715xxxxxxxx">
                <div id="phone-error" class="error-message" style="color: #ff6b6b; font-size: 12px; margin-top: 5px; display: none;">ูุฑุฌู ุฅุฏุฎุงู ุฑูู ุฌูุงู ุฅูุงุฑุงุชู ุตุญูุญ</div>
            </div>
            
            <div style="margin-bottom: 2rem;">
                <label style="display: block; margin-bottom: 0.5rem; color: #333; font-weight: 600;">ุงูุชุจ ุฃู ููุงุญุธุงุช ูุฏูู (ุงุฎุชูุงุฑู)</label>
                <textarea id="notes" rows="2" 
                          style="width: 100%; padding: 12px; border: 2px solid #e0e0e0; border-radius: 8px; font-size: 16px; resize: vertical;" 
                          placeholder="ุฃู ููุงุญุธุงุช ุฅุถุงููุฉ ูุทูุจู"></textarea>
            </div>
            
            <div style="margin-bottom: 2rem; padding: 1rem; background: #fff3cd; border-radius: 8px; border-left: 4px solid #ffc107;">
                <p style="margin: 0; font-size: 14px; color: #856404;">
                    ๐ <strong>ุณูุงุณุฉ ุงูุฅุฑุฌุงุน:</strong> ูููู ุฅุฑุฌุงุน ุงูููุชุฌุงุช ุฎูุงู 14 ููู ููุท. ููุชุฌุงุช ุงูุนูุงูุฉ ุงูุดุฎุตูุฉ ุบูุฑ ูุงุจูุฉ ููุฅุฑุฌุงุน.
                </p>
            </div>
            
            <div style="display: flex; gap: 1rem; flex-wrap: wrap;">
                <a href="cart.html" class="btn btn-secondary" style="flex: 1; min-width: 150px; text-decoration: none; text-align: center;">ุงูุนูุฏุฉ ููุณูุฉ</a>
                <button type="submit" class="btn btn-primary" style="flex: 2; min-width: 200px; font-size: 16px; font-weight: 700;">
                    ๐ฌ ุฅุฑุณุงู ุงูุทูุจ ุนุจุฑ ูุงุชุณุงุจ
                </button>
            </div>
        </form>
    </section>

    <script>
        function validateUAEPhone(phone) {
            // ุชูุธูู ุงูุฑูู
            phone = phone.replace(/\s+/g, '').replace(/[^\d+]/g, '');
            
            // ุงูุตูุบ ุงูููุจููุฉ ูุฃุฑูุงู ุงูุฅูุงุฑุงุช
            const uaePatterns = [
                /^(\+971|971)?0?5[0-9]{8}$/, // ุฌูุงู
                /^(\+971|971)?0?[2-4-6-9][0-9]{7}$/ // ูุงุชู ุซุงุจุช
            ];
            
            return uaePatterns.some(pattern => pattern.test(phone));
        }
        
        function formatUAEPhone(phone) {
            phone = phone.replace(/\s+/g, '').replace(/[^\d+]/g, '');
            
            if (phone.startsWith('05')) {
                return '+971' + phone.substring(1);
            }
            if (phone.startsWith('5') && phone.length === 9) {
                return '+971' + phone;
            }
            if (phone.startsWith('971')) {
                return '+' + phone;
            }
            if (phone.startsWith('+971')) {
                return phone;
            }
            
            return phone;
        }
        
        document.getElementById('checkout-form').addEventListener('submit', function(e) {
            e.preventDefault();
            
            // ุงูุญููู ุงููุทููุจุฉ
            const fullName = document.getElementById('fullName').value.trim();
            const address = document.getElementById('address').value.trim();
            const phone = document.getElementById('phone').value.trim();
            const notes = document.getElementById('notes').value.trim();
            
            // ุฅุฎูุงุก ุฌููุน ุฑุณุงุฆู ุงูุฎุทุฃ
            document.querySelectorAll('.error-message').forEach(el => el.style.display = 'none');
            
            let hasError = false;
            
            // ุชุญูู ูู ุงูุงุณู
            if (!fullName || fullName.length < 3) {
                document.getElementById('name-error').style.display = 'block';
                hasError = true;
            }
            
            // ุชุญูู ูู ุงูุนููุงู
            if (!address || address.length < 10) {
                document.getElementById('address-error').style.display = 'block';
                hasError = true;
            }
            
            // ุชุญูู ูู ุฑูู ุงูุฌูุงู
            if (!phone || !validateUAEPhone(phone)) {
                document.getElementById('phone-error').style.display = 'block';
                hasError = true;
            }
            
            if (hasError) return;
            
            // ุชุญููู ุงูุณูุฉ
            const cart = JSON.parse(localStorage.getItem('hadaya-cart') || '[]');
            
            if (cart.length === 0) {
                alert('ุณูุฉ ุงูุชุณูู ูุงุฑุบุฉ. ูุฑุฌู ุฅุถุงูุฉ ููุชุฌุงุช ุฃููุงู.');
                window.location.href = '/';
                return;
            }
            
            // ุฅุนุฏุงุฏ ุฑุณุงูุฉ ุงูุทูุจ
            const formattedPhone = formatUAEPhone(phone);
            let orderMessage = `๐ *ุทูุจ ุฌุฏูุฏ ูู ูุฏุงูุง ุงูุฅูุงุฑุงุช*\n\n`;
            orderMessage += `๐ค *ุจูุงูุงุช ุงูุนููู:*\n`;
            orderMessage += `โข ุงูุงุณู: ${fullName}\n`;
            orderMessage += `โข ุงูุนููุงู: ${address}\n`;
            orderMessage += `โข ุงูุฌูุงู: ${formattedPhone}\n\n`;
            
            orderMessage += `๐ *ุชูุงุตูู ุงูุทูุจ:*\n`;
            let total = 0;
            cart.forEach((item, index) => {
                orderMessage += `${index + 1}. ${item.title}\n`;
                orderMessage += `   ุงูุณุนุฑ: ${item.price} ุฏุฑูู\n\n`;
                total += item.price;
            });
            
            orderMessage += `๐ฐ *ุงูุฅุฌูุงูู: ${total} ุฏุฑูู*\n\n`;
            
            if (notes) {
                orderMessage += `๐ *ููุงุญุธุงุช:*\n${notes}\n\n`;
            }
            
            orderMessage += `โจ ุดูุฑุงู ูุงุฎุชูุงุฑูู ูุฏุงูุง ุงูุฅูุงุฑุงุช!`;
            
            // ูุชุญ ูุงุชุณุงุจ
            const whatsappUrl = `https://wa.me/201110760081?text=${encodeURIComponent(orderMessage)}`;
            window.open(whatsappUrl, '_blank');
            
            // ุฅุธูุงุฑ ุฑุณุงูุฉ ูุฌุงุญ
            alert('ุชู ุฅุฑุณุงู ุทูุจู ุจูุฌุงุญ! ุณูุชู ุงูุชูุงุตู ูุนู ูุฑูุจุงู.');
            
            // ุชูุฑูุบ ุงูุณูุฉ ุจุนุฏ ุงูุทูุจ
            localStorage.removeItem('hadaya-cart');
            
            // ุงูุนูุฏุฉ ููุฑุฆูุณูุฉ ุจุนุฏ 3 ุซูุงู
            setTimeout(() => {
                window.location.href = '/';
            }, 3000);
        });
        
        // ุชุญุฏูุซ ููู ุงูุญููู ุนูุฏ ุงูุชุฑููุฒ
        document.querySelectorAll('input, textarea').forEach(field => {
            field.addEventListener('focus', function() {
                this.style.borderColor = '#667eea';
            });
            field.addEventListener('blur', function() {
                this.style.borderColor = '#e0e0e0';
            });
        });
    </script>
</body>
</html>