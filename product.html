<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title id="pageTitle">منتج - متجر هدايا الإمارات</title>
    <meta id="pageDescription" name="description" content="">
    <meta id="pageKeywords" name="keywords" content="">
    
    <!-- SEO و Open Graph -->
    <link rel="canonical" id="pageCanonical" href="https://hadaya-emirates.arabsad.com/product.html">
    <meta property="og:title" id="ogTitle" content="">
    <meta property="og:description" id="ogDescription" content="">
    <meta property="og:image" id="ogImage" content="">
    <meta property="og:url" id="ogUrl" content="">
    
    <!-- Fonts & Icons -->
    <link href="https://fonts.googleapis.com/css2?family=Cairo:wght@300;400;600;700;900&display=swap" rel="stylesheet">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" rel="stylesheet">
    
    <!-- Styles -->
    <link rel="stylesheet" href="style.css">
    <style>
        .product-detail {
            padding: 2rem 0;
        }
        
        .product-detail-container {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 3rem;
            margin-bottom: 3rem;
        }
        
        .product-images {
            position: relative;
        }
        
        .main-image {
            width: 100%;
            aspect-ratio: 1;
            border-radius: var(--border-radius);
            overflow: hidden;
            box-shadow: var(--shadow-lg);
        }
        
        .main-image img {
            width: 100%;
            height: 100%;
            object-fit: cover;
        }
        
        .product-info-detail {
            display: flex;
            flex-direction: column;
            gap: 1.5rem;
        }
        
        .breadcrumb {
            display: flex;
            align-items: center;
            gap: 0.5rem;
            margin-bottom: 2rem;
            color: var(--gray-600);
            font-size: 0.875rem;
        }
        
        .breadcrumb a {
            color: var(--primary-color);
            text-decoration: none;
        }
        
        .breadcrumb a:hover {
            text-decoration: underline;
        }
        
        .product-title-detail {
            font-size: 2rem;
            font-weight: 800;
            color: var(--dark-color);
            line-height: 1.3;
        }
        
        .product-brand {
            color: var(--primary-color);
            font-weight: 600;
            font-size: 1.125rem;
        }
        
        .product-rating-detail {
            display: flex;
            align-items: center;
            gap: 1rem;
        }
        
        .rating-score {
            font-size: 1.125rem;
            font-weight: 700;
            color: var(--dark-color);
        }
        
        .product-prices-detail {
            display: flex;
            align-items: center;
            gap: 1rem;
            padding: 1rem;
            background: var(--light-color);
            border-radius: var(--border-radius);
        }
        
        .current-price-detail {
            font-size: 2rem;
            font-weight: 900;
            color: var(--primary-color);
        }
        
        .original-price-detail {
            font-size: 1.25rem;
            color: var(--gray-600);
            text-decoration: line-through;
        }
        
        .discount-detail {
            background: var(--success-color);
            color: white;
            padding: 0.5rem 1rem;
            border-radius: 2rem;
            font-weight: 700;
            font-size: 1rem;
        }
        
        .product-description-detail {
            color: var(--gray-700);
            line-height: 1.8;
            font-size: 1rem;
        }
        
        .product-features {
            border: 1px solid var(--border-color);
            border-radius: var(--border-radius);
            padding: 1.5rem;
        }
        
        .product-features h4 {
            color: var(--dark-color);
            margin-bottom: 1rem;
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }
        
        .features-list {
            list-style: none;
        }
        
        .features-list li {
            padding: 0.5rem 0;
            display: flex;
            align-items: center;
            gap: 0.5rem;
            border-bottom: 1px solid var(--gray-200);
        }
        
        .features-list li:last-child {
            border-bottom: none;
        }
        
        .features-list li i {
            color: var(--success-color);
        }
        
        .product-actions-detail {
            display: flex;
            gap: 1rem;
            margin-top: 1rem;
        }
        
        .add-to-cart-detail {
            flex: 2;
            background: var(--primary-color);
            color: white;
            padding: 1rem 2rem;
            border-radius: var(--border-radius);
            font-size: 1.125rem;
            font-weight: 700;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 0.75rem;
            transition: var(--transition);
        }
        
        .add-to-cart-detail:hover {
            background: var(--primary-dark);
            transform: translateY(-2px);
            box-shadow: var(--shadow-lg);
        }
        
        .whatsapp-btn {
            flex: 1;
            background: #25d366;
            color: white;
            padding: 1rem;
            border-radius: var(--border-radius);
            font-weight: 600;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 0.5rem;
            text-decoration: none;
            transition: var(--transition);
        }
        
        .whatsapp-btn:hover {
            background: #128c7e;
            transform: translateY(-2px);
        }
        
        .back-btn {
            background: var(--gray-100);
            color: var(--text-color);
            padding: 0.75rem 1.5rem;
            border-radius: var(--border-radius);
            display: flex;
            align-items: center;
            gap: 0.5rem;
            text-decoration: none;
            transition: var(--transition);
            margin-bottom: 1rem;
            width: fit-content;
        }
        
        .back-btn:hover {
            background: var(--gray-200);
        }
        
        .product-not-found {
            text-align: center;
            padding: 4rem 2rem;
            color: var(--gray-600);
        }
        
        .product-not-found i {
            font-size: 4rem;
            margin-bottom: 2rem;
            color: var(--gray-300);
        }
        
        .product-not-found h2 {
            font-size: 2rem;
            margin-bottom: 1rem;
            color: var(--dark-color);
        }
        
        @media (max-width: 768px) {
            .product-detail-container {
                grid-template-columns: 1fr;
                gap: 2rem;
            }
            
            .product-title-detail {
                font-size: 1.5rem;
            }
            
            .current-price-detail {
                font-size: 1.5rem;
            }
            
            .product-actions-detail {
                flex-direction: column;
            }
        }
    </style>
</head>

<body>
    <!-- Header -->
    <header class="site-header">
        <div class="header-top">
            <div class="container">
                <div class="contact-info">
                    <div class="contact-item uae-exclusive">
                        <i class="fas fa-flag"></i>
                        <span>🇦🇪 خدمة حصرية للمقيمين في الإمارات</span>
                    </div>
                    <div class="contact-item">
                        <i class="fab fa-whatsapp"></i>
                        <span>واتساب: +201110760081</span>
                    </div>
                </div>
                <div class="contact-item">
                    <i class="fas fa-shipping-fast"></i>
                    <span>شحن مجاني داخل الإمارات</span>
                </div>
            </div>
        </div>
        
        <nav class="main-nav">
            <div class="container">
                <div class="nav-content">
                    <div class="logo">
                        <h1><a href="/">🇦🇪 متجر هدايا الإمارات</a></h1>
                        <p class="tagline">أجود الهدايا الفاخرة</p>
                    </div>
                    
                    <div class="header-actions">
                        <div class="action-btn" id="cartBtn" onclick="toggleCart()">
                            <i class="fas fa-shopping-cart"></i>
                            <span>السلة</span>
                            <span class="cart-counter" id="cartCounter" style="display:none">0</span>
                        </div>
                        <a href="https://wa.me/201110760081" target="_blank" class="action-btn">
                            <i class="fab fa-whatsapp"></i>
                            <span>تواصل</span>
                        </a>
                    </div>
                </div>
            </div>
        </nav>
    </header>

    <!-- Cart Sidebar -->
    <div id="cartSidebar" class="cart-sidebar">
        <div class="cart-header">
            <h3><i class="fas fa-shopping-cart"></i> سلة التسوق</h3>
            <button onclick="toggleCart()" class="close-cart"><i class="fas fa-times"></i></button>
        </div>
        <div id="cartItems" class="cart-items">
            <div class="empty-cart">
                <i class="fas fa-shopping-cart"></i>
                <p>سلتك فارغة</p>
                <small>ابدأ بإضافة منتجات للسلة</small>
            </div>
        </div>
        <div class="cart-footer">
            <div class="cart-total">
                <strong>الإجمالي: <span id="cartTotal">0</span> درهم</strong>
            </div>
            <button id="checkoutBtn" onclick="proceedToWhatsApp()" class="checkout-btn" disabled>
                <i class="fab fa-whatsapp"></i>
                أرسل الطلب عبر واتساب
            </button>
        </div>
    </div>
    <div id="cartOverlay" class="cart-overlay" onclick="toggleCart()"></div>

    <!-- Main Content -->
    <main class="main-content">
        <div class="container">
            <!-- Back Button -->
            <a href="/" class="back-btn">
                <i class="fas fa-arrow-right"></i>
                عودة للمتجر
            </a>

            <!-- Loading State -->
            <div id="loadingState">
                <div class="loading-spinner"></div>
                <p style="text-align:center;margin-top:1rem;color:#6b7280">جاري تحميل تفاصيل المنتج...</p>
            </div>

            <!-- Product Not Found -->
            <div id="productNotFound" class="product-not-found" style="display:none">
                <i class="fas fa-box-open"></i>
                <h2>لم يتم العثور على هذا المنتج</h2>
                <p>المنتج الذي تبحث عنه ليس متاحاً حالياً أو قد يكون الرابط غير صحيح</p>
                <a href="/" class="btn btn-primary" style="margin-top:2rem">
                    <i class="fas fa-home"></i> عودة للمتجر
                </a>
            </div>

            <!-- Product Detail -->
            <div id="productDetail" class="product-detail" style="display:none">
                <!-- Breadcrumb -->
                <div class="breadcrumb">
                    <a href="/">الرئيسية</a>
                    <i class="fas fa-chevron-left"></i>
                    <span id="categoryBreadcrumb">المنتجات</span>
                    <i class="fas fa-chevron-left"></i>
                    <span id="productBreadcrumb">المنتج</span>
                </div>

                <div class="product-detail-container">
                    <!-- Product Images -->
                    <div class="product-images">
                        <div class="main-image">
                            <img id="productImage" src="" alt="" onerror="this.src='https://images.unsplash.com/photo-1523275335684-37898b6baf30?w=600&h=600&fit=crop'">
                        </div>
                    </div>

                    <!-- Product Info -->
                    <div class="product-info-detail">
                        <div>
                            <div class="product-brand" id="productBrand"></div>
                            <h1 class="product-title-detail" id="productTitle"></h1>
                        </div>
                        
                        <div class="product-rating-detail">
                            <div class="stars" id="productStars"></div>
                            <span class="rating-score" id="productRating"></span>
                            <span class="rating-text" id="productReviews"></span>
                        </div>
                        
                        <div class="product-prices-detail">
                            <span class="current-price-detail" id="productSalePrice"></span>
                            <span class="original-price-detail" id="productPrice"></span>
                            <span class="discount-detail" id="productDiscount"></span>
                        </div>
                        
                        <p class="product-description-detail" id="productDescription"></p>
                        
                        <div class="product-features">
                            <h4><i class="fas fa-check-circle"></i> ميزات المنتج</h4>
                            <ul class="features-list">
                                <li><i class="fas fa-check"></i> ضمان الأصالة 100%</li>
                                <li><i class="fas fa-check"></i> شحن مجاني داخل الإمارات</li>
                                <li><i class="fas fa-check"></i> خدمة عملاء 24/7</li>
                                <li><i class="fas fa-check"></i> امكانية الارجاع والاستبدال</li>
                                <li><i class="fas fa-check"></i> تغليف فاخر وهدايا مجانية</li>
                            </ul>
                        </div>
                        
                        <div class="product-actions-detail">
                            <button class="add-to-cart-detail" id="addToCartBtn">
                                <i class="fas fa-cart-plus"></i>
                                أضف للسلة
                            </button>
                            <a id="whatsappBtn" class="whatsapp-btn" href="#" target="_blank">
                                <i class="fab fa-whatsapp"></i>
                                استفسار
                            </a>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </main>

    <!-- Scripts -->
    <script src="products-data.js"></script>
    <script>
        // Product page specific JavaScript
        let currentProduct = null;
        let cart = JSON.parse(localStorage.getItem('hadayaCart') || '[]');
        
        // Initialize product page
        document.addEventListener('DOMContentLoaded', function() {
            // Get slug from URL
            const urlParams = new URLSearchParams(window.location.search);
            const slug = urlParams.get('slug');
            
            if (!slug) {
                showProductNotFound();
                return;
            }
            
            // Wait for products data
            if (typeof window.productsData !== 'undefined') {
                loadProduct(slug);
            } else {
                setTimeout(() => {
                    if (typeof window.productsData !== 'undefined') {
                        loadProduct(slug);
                    } else {
                        showProductNotFound();
                    }
                }, 500);
            }
            
            updateCartUI();
        });
        
        function loadProduct(slug) {
            currentProduct = getProductBySlug(slug);
            
            if (!currentProduct) {
                showProductNotFound();
                return;
            }
            
            displayProduct(currentProduct);
            updateSEO(currentProduct);
        }
        
        function displayProduct(product) {
            document.getElementById('loadingState').style.display = 'none';
            document.getElementById('productDetail').style.display = 'block';
            
            // Update breadcrumb
            document.getElementById('categoryBreadcrumb').textContent = product.category;
            document.getElementById('productBreadcrumb').textContent = product.title;
            
            // Update product details
            document.getElementById('productImage').src = product.image;
            document.getElementById('productImage').alt = product.title;
            document.getElementById('productBrand').textContent = product.brand;
            document.getElementById('productTitle').textContent = product.title;
            document.getElementById('productDescription').textContent = product.description;
            
            // Rating
            document.getElementById('productStars').innerHTML = generateStars(product.rating);
            document.getElementById('productRating').textContent = product.rating.toFixed(1);
            document.getElementById('productReviews').textContent = `(${product.reviews} تقييم)`;
            
            // Prices
            document.getElementById('productSalePrice').textContent = `${product.salePrice} درهم`;
            document.getElementById('productPrice').textContent = `${product.price} درهم`;
            document.getElementById('productDiscount').textContent = `-${product.discount}%`;
            
            // WhatsApp inquiry link
            const whatsappMessage = `مرحباً! أريد الاستفسار عن هذا المنتج:\n\n${product.title}\nالسعر: ${product.salePrice} درهم\n\nرابط المنتج: ${window.location.href}`;
            document.getElementById('whatsappBtn').href = `https://wa.me/201110760081?text=${encodeURIComponent(whatsappMessage)}`;
            
            // Add to cart button
            document.getElementById('addToCartBtn').onclick = () => addToCart(product.id);
        }
        
        function updateSEO(product) {
            // Update page title and meta
            document.getElementById('pageTitle').textContent = `${product.title} - متجر هدايا الإمارات`;
            document.title = `${product.title} - متجر هدايا الإمارات`;
            document.getElementById('pageDescription').content = product.description;
            document.getElementById('pageKeywords').content = `${product.title}, ${product.brand}, ${product.category}, هدايا, الإمارات`;
            
            // Open Graph
            document.getElementById('ogTitle').content = product.title;
            document.getElementById('ogDescription').content = product.description;
            document.getElementById('ogImage').content = product.image;
            document.getElementById('ogUrl').content = window.location.href;
            document.getElementById('pageCanonical').href = window.location.href;
        }
        
        function showProductNotFound() {
            document.getElementById('loadingState').style.display = 'none';
            document.getElementById('productNotFound').style.display = 'block';
        }
        
        function generateStars(rating) {
            const fullStars = Math.floor(rating);
            const hasHalfStar = rating % 1 >= 0.5;
            const emptyStars = 5 - fullStars - (hasHalfStar ? 1 : 0);
            
            let stars = '';
            
            for (let i = 0; i < fullStars; i++) {
                stars += '<i class="fas fa-star star"></i>';
            }
            
            if (hasHalfStar) {
                stars += '<i class="fas fa-star-half-alt star"></i>';
            }
            
            for (let i = 0; i < emptyStars; i++) {
                stars += '<i class="far fa-star star empty"></i>';
            }
            
            return stars;
        }
        
        // Cart functions (same as main.js)
        function addToCart(productId) {
            const product = getProductById(productId);
            if (!product) return;
            
            const existingItem = cart.find(item => item.id === productId);
            
            if (existingItem) {
                existingItem.quantity += 1;
            } else {
                cart.push({
                    id: product.id,
                    title: product.title,
                    price: product.salePrice,
                    image: product.image,
                    slug: product.slug,
                    quantity: 1
                });
            }
            
            localStorage.setItem('hadayaCart', JSON.stringify(cart));
            updateCartUI();
            showAddedToCartMessage(product.title);
        }
        
        function removeFromCart(productId) {
            cart = cart.filter(item => item.id !== productId);
            localStorage.setItem('hadayaCart', JSON.stringify(cart));
            updateCartUI();
        }
        
        function updateQuantity(productId, quantity) {
            const item = cart.find(item => item.id === productId);
            if (item) {
                if (quantity <= 0) {
                    removeFromCart(productId);
                } else {
                    item.quantity = quantity;
                    localStorage.setItem('hadayaCart', JSON.stringify(cart));
                    updateCartUI();
                }
            }
        }
        
        function updateCartUI() {
            const cartCounter = document.getElementById('cartCounter');
            const cartItems = document.getElementById('cartItems');
            const cartTotal = document.getElementById('cartTotal');
            const checkoutBtn = document.getElementById('checkoutBtn');
            
            const totalItems = cart.reduce((sum, item) => sum + item.quantity, 0);
            
            if (totalItems > 0) {
                cartCounter.style.display = 'flex';
                cartCounter.textContent = totalItems;
            } else {
                cartCounter.style.display = 'none';
            }
            
            if (cart.length === 0) {
                cartItems.innerHTML = `
                    <div class="empty-cart">
                        <i class="fas fa-shopping-cart"></i>
                        <p>سلتك فارغة</p>
                        <small>ابدأ بإضافة منتجات للسلة</small>
                    </div>
                `;
                checkoutBtn.disabled = true;
                cartTotal.textContent = '0';
            } else {
                const itemsHtml = cart.map(item => `
                    <div class="cart-item">
                        <img src="${item.image}" alt="${item.title}">
                        <div class="cart-item-info">
                            <div class="cart-item-title">${item.title}</div>
                            <div class="cart-item-price">${item.price} درهم</div>
                            <div class="cart-item-controls">
                                <button onclick="updateQuantity(${item.id}, ${item.quantity - 1})">
                                    <i class="fas fa-minus"></i>
                                </button>
                                <span class="quantity">${item.quantity}</span>
                                <button onclick="updateQuantity(${item.id}, ${item.quantity + 1})">
                                    <i class="fas fa-plus"></i>
                                </button>
                                <button onclick="removeFromCart(${item.id})" class="remove-btn">
                                    <i class="fas fa-trash"></i>
                                </button>
                            </div>
                        </div>
                    </div>
                `).join('');
                
                cartItems.innerHTML = itemsHtml;
                
                const total = cart.reduce((sum, item) => sum + (item.price * item.quantity), 0);
                cartTotal.textContent = total;
                checkoutBtn.disabled = false;
            }
        }
        
        function toggleCart() {
            const cartSidebar = document.getElementById('cartSidebar');
            const cartOverlay = document.getElementById('cartOverlay');
            const isActive = cartSidebar.classList.contains('active');
            
            if (isActive) {
                cartSidebar.classList.remove('active');
                cartOverlay.classList.remove('active');
                document.body.style.overflow = '';
            } else {
                cartSidebar.classList.add('active');
                cartOverlay.classList.add('active');
                document.body.style.overflow = 'hidden';
            }
        }
        
        function proceedToWhatsApp() {
            if (cart.length === 0) return;
            
            let message = '🛋️ طلب جديد من متجر هدايا الإمارات\n\n';
            
            cart.forEach((item, index) => {
                message += `${index + 1}. ${item.title}\n`;
                message += `   السعر: ${item.price} درهم\n`;
                message += `   الكمية: ${item.quantity}\n`;
                message += `   الإجمالي: ${item.price * item.quantity} درهم\n\n`;
            });
            
            const total = cart.reduce((sum, item) => sum + (item.price * item.quantity), 0);
            message += `💰 إجمالي الطلب: ${total} درهم\n`;
            message += `🇦🇪 شحن مجاني داخل الإمارات\n`;
            message += `\nرابط المتجر: https://hadaya-emirates.arabsad.com`;
            
            const whatsappUrl = `https://wa.me/201110760081?text=${encodeURIComponent(message)}`;
            window.open(whatsappUrl, '_blank');
        }
        
        function showAddedToCartMessage(productTitle) {
            const notification = document.createElement('div');
            notification.innerHTML = `
                <div style="position: fixed; top: 100px; right: 20px; background: var(--success-color); color: white; 
                            padding: 1rem 1.5rem; border-radius: var(--border-radius); box-shadow: var(--shadow-lg); 
                            z-index: 3000; animation: slideInRight 0.3s ease;">
                    <i class="fas fa-check-circle"></i> تمت إضافة المنتج للسلة!
                </div>
            `;
            
            document.body.appendChild(notification);
            
            setTimeout(() => {
                notification.remove();
            }, 3000);
        }
    </script>
</body>
</html>