<!-- Smart Popup -->
<div id="smart-popup" class="popup-overlay" style="display:none;">
  <div class="popup-content">
    <button class="popup-close" onclick="closePopup()">âœ•</button>
    <div class="popup-header">
      <div class="popup-icon">ðŸŽ‰</div>
      <h3>Ø¹Ø±Ø¶ Ø®Ø§Øµ Ù„Ø²ÙˆØ§Ø± Ø§Ù„Ù…ÙˆÙ‚Ø¹!</h3>
    </div>
    <div class="popup-body">
      <p>Ø§Ø­ØµÙ„ Ø¹Ù„Ù‰ <strong>Ø®ØµÙ… 15%</strong> Ø¹Ù„Ù‰ Ø·Ù„Ø¨Ùƒ Ø§Ù„Ø£ÙˆÙ„</p>
      <p>Ø§Ø³ØªØ®Ø¯Ù… ÙƒÙˆØ¯: <strong style="background:#667eea;color:white;padding:5px 10px;border-radius:5px;">WELCOME15</strong></p>
    </div>
    <div class="popup-actions">
      <button class="popup-btn primary" onclick="applyDiscount()">ðŸ›’ ØªØ·Ø¨ÙŠÙ‚ Ø§Ù„Ø®ØµÙ…</button>
      <button class="popup-btn secondary" onclick="closePopup()">Ø±Ø¨Ù…Ø§ Ù„Ø§Ø­Ù‚Ø§Ù‹</button>
    </div>
  </div>
</div>

<style>
.popup-overlay{position:fixed;top:0;left:0;width:100%;height:100%;background:rgba(0,0,0,0.7);z-index:10000;display:flex;align-items:center;justify-content:center}
.popup-content{background:white;border-radius:20px;padding:2rem;max-width:400px;margin:20px;text-align:center;position:relative;animation:popupSlide 0.3s ease-out}
.popup-close{position:absolute;top:15px;right:20px;background:none;border:none;font-size:1.5rem;cursor:pointer;color:#999}
.popup-icon{font-size:3rem;margin-bottom:1rem}
.popup-header h3{color:#333;margin-bottom:1rem}
.popup-body{margin:1.5rem 0;color:#666;line-height:1.6}
.popup-actions{display:flex;gap:10px;justify-content:center}
.popup-btn{padding:12px 24px;border:none;border-radius:25px;cursor:pointer;font-weight:600;transition:all 0.3s}
.popup-btn.primary{background:#25d366;color:white}
.popup-btn.secondary{background:#f0f0f0;color:#666}
.popup-btn:hover{transform:translateY(-2px)}
@keyframes popupSlide{from{transform:translateY(-50px);opacity:0}to{transform:translateY(0);opacity:1}}
</style>

<script>
function showSmartPopup() {
  setTimeout(() => {
    if (!localStorage.getItem('popup-shown-today')) {
      document.getElementById('smart-popup').style.display = 'flex';
    }
  }, 5000);
  
  document.addEventListener('mouseleave', function(e) {
    if (e.clientY <= 0 && !localStorage.getItem('popup-shown-today')) {
      document.getElementById('smart-popup').style.display = 'flex';
    }
  });
}

function closePopup() {
  document.getElementById('smart-popup').style.display = 'none';
  localStorage.setItem('popup-shown-today', new Date().toDateString());
}

function applyDiscount() {
  gtag('event', 'promotion_click', {
    'promotion_id': 'WELCOME15',
    'promotion_name': 'First Visit Discount'
  });
  alert('ðŸŽ‰ ØªÙ… ØªØ·Ø¨ÙŠÙ‚ Ø®ØµÙ… 15%! Ø§Ø³ØªØ®Ø¯Ù… Ø§Ù„ÙƒÙˆØ¯ WELCOME15 Ø¹Ù†Ø¯ Ø§Ù„Ø·Ù„Ø¨');
  closePopup();
}

document.addEventListener('DOMContentLoaded', showSmartPopup);
</script>